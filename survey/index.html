<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DUET 創作者深度訪談</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #d4af37; --bg: #0a0e14; }
        
        body { 
            font-family: "Noto Sans TC", "PingFang TC", "STHeitiTC-Light", "Microsoft JhengHei", sans-serif; 
            background-color: var(--bg); 
            color: #fff; 
            line-height: 1.8; 
            padding: 20px; 
            margin: 0; 
            zoom: 0.6; 
            -moz-transform: scale(0.7); 
            -moz-transform-origin: top center; 
            font-size: 20px;
            font-weight: 300; 
            letter-spacing: 0.5px;
            -webkit-font-smoothing: antialiased;
        }
        
        /* 修改點：寬度再次增加至 1200px，給予照片絕對充足的空間 */
        .container { 
            max-width: 1200px; 
            margin: 40px auto; 
            background: rgba(255,255,255,0.03); 
            padding: 50px 70px; /* 增加左右內距 */
            border-radius: 24px; 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255,255,255,0.1); 
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); 
        }
        
        h1 { color: var(--gold); text-align: center; margin-bottom: 20px; letter-spacing: 4px; font-weight: 300; }
        .concept-note { text-align: center; color: #aaa; font-size: 20px; margin-bottom: 40px; padding: 0 20px; line-height: 1.8; }
        .question-group { margin-bottom: 70px; padding-bottom: 50px; border-bottom: 1px solid rgba(255,255,255,0.08); }
        
        label { display: block; font-size: 26px; margin-bottom: 15px; color: var(--gold); font-weight: 400; }
        
        input[type="text"], input[type="email"], textarea, select {
            width: 100%; padding: 18px; background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px; color: #fff; font-size: 24px; transition: 0.3s; box-sizing: border-box;
            font-family: inherit; font-weight: 300;
        }
        input:focus, textarea:focus { outline: none; border-color: var(--gold); background: rgba(255,255,255,0.12); }

        .font-trigger {
            width: 100%; padding: 14px; background: rgba(255,255,255,0.1); border: 1px solid var(--gold);
            border-radius: 10px; color: var(--gold); font-size: 16px; cursor: pointer; text-align: left;
            font-family: inherit;
        }

        /* 修改點：大幅增加 gap 以補償 scale(1.3) 佔用的空間 */
        .image-options { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 120px 100px; /* 再次增加左右 (100px) 與上下 (120px) 的距離 */
            margin-top: 70px; 
            padding: 30px; 
        }
        
        /* 圖片卡片保持 1.3 倍放大 */
        .img-card { cursor: pointer; border: 2px solid transparent; border-radius: 12px; overflow: hidden; transition: 0.4s; position: relative; background: #1a1a1a; transform: scale(1.3); }
        .img-card img { width: 100%; height: 160px; object-fit: cover; display: block; filter: grayscale(10%); }
        #mag-options .img-card img { height: 220px; object-fit: contain; background: #000; }
        
        /* 照片名稱字體加大 2 級 (14px) */
        .img-card p { font-size: 14px; text-align: center; padding: 10px; background: rgba(0,0,0,0.85); margin: 0; color: #fff; letter-spacing: 1px; font-weight: 500; }
        .img-card.selected { border-color: var(--gold); box-shadow: 0 0 25px rgba(212, 175, 55, 0.7); }

        #font-selector-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 9999; padding: 40px; box-sizing: border-box; }
        .modal-body { max-width: 1200px; margin: 0 auto; height: 100%; display: flex; flex-direction: column; }
        .font-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; overflow-y: auto; padding: 20px 0; }
        .font-card { background: rgba(255,255,255,0.05); padding: 30px 20px; border-radius: 12px; text-align: center; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); transition: 0.3s; }
        .preview-char { font-size: 48px; margin-bottom: 10px; color: #fff; line-height: 1; }
        
        .submit-btn { width: 100%; padding: 22px; background: var(--gold); color: #000; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 22px; margin-top: 30px; letter-spacing: 2px; font-family: inherit; }
        .font-selection-wrapper { display: flex; justify-content: center; gap: 40px; max-width: 700px; margin: 0 auto; }
        .font-selection-item { flex: 1; }
    </style>
</head>
<body>

<div class="container">
    <h1>DUET 創作者深度訪談</h1>
    <p class="concept-note">「美好的關係，是兩個人各自保有自我，並在交集中找到和諧與共鳴。」</p>
    
    <div class="question-group" style="display: flex; gap: 20px;">
        <div style="flex:1;"><label>您的姓名</label><input type="text" id="name" placeholder="請輸入姓名"></div>
        <div style="flex:1;"><label>您的 E-mail</label><input type="email" id="email" placeholder="example@gmail.com"></div>
    </div>

    <div class="question-group">
        <label>1. 如果您要訂製一個飾品，而這件飾品上可以包含兩個字母，您會選哪兩個字母？(大小寫皆可)</label>
        <div style="display:flex; gap:15px;">
            <input type="text" id="L1" maxlength="1" placeholder="A" style="width:100px; text-align:center;" oninput="updateDynamicLabels()">
            <input type="text" id="L2" maxlength="1" placeholder="B" style="width:100px; text-align:center;" oninput="updateDynamicLabels()">
        </div>
    </div>

    <div class="question-group">
        <label id="label_Q2">2. 「？」對您的意義是什麼？</label>
        <textarea id="Q1_reason" rows="2"></textarea>
    </div>

    <div class="question-group">
        <label id="label_Q3">3. 「？」對您的意義是什麼？</label>
        <textarea id="Q1_2_reason" rows="2"></textarea>
    </div>

    <div class="question-group">
        <label>4. 你們最重要的共通點是什麼？</label>
        <textarea id="Q2" rows="2" placeholder="例如：我們都對美感有強烈追求"></textarea>
    </div>

    <div class="question-group">
        <label>5. 你們之間最難忘的共同回憶？</label>
        <textarea id="Q2_5" rows="2"></textarea>
    </div>

    <div class="question-group">
        <label>6. 對方為你的生命帶來了什麼不同？</label>
        <textarea id="Q3" rows="3"></textarea>
    </div>

    <div class="question-group">
        <label>7. 你想透過這件作品傳達什麼給對方？</label>
        <textarea id="Q3_5" rows="2"></textarea>
    </div>

    <div class="question-group">
        <label>8. 請用三個形容詞描述對方？</label>
        <input type="text" id="Q4" placeholder="務必填寫三個形容詞，例如：優雅、情緒化、溫暖">
    </div>

    <div class="question-group">
        <label>9. 對方在你生命中為什麼重要？</label>
        <textarea id="Q5" rows="3"></textarea>
    </div>

    <div class="question-group">
        <label>10. 你最欣賞你送禮對象的哪一點？（如果是送給自己的，更值得好好回答）</label>
        <textarea id="Q5_5" rows="3" placeholder="例如：欣賞她面對挑戰的韌性"></textarea>
    </div>

    <div class="question-group">
        <label>11. 您們兩人的相處模式，最像音樂中的哪種曲風？</label>
        <select id="Q6">
            <option value="平靜悠揚的鋼琴二重奏">平靜悠揚的鋼琴二重奏</option>
            <option value="互補且自由的爵士即興">互補且自由的爵士即興</option>
            <option value="澎湃激昂的交響樂">澎湃激昂的交響樂</option>
            <option value="韓國流行樂">韓國流行樂</option>
            <option value="華語流行樂">華語流行樂</option>
            <option value="搖滾">搖滾</option>
            <option value="電音">電音</option>
            <option value="電影原聲帶">電影原聲帶</option>
            <option value="動漫配樂">動漫配樂</option>
            <option value="其他">其他</option>
        </select>
    </div>

    <div class="question-group">
        <label>12. 如果你們的「關係」用一個空間的氛圍來比喻，最接近以下哪個空間？</label>
        <div class="image-options" id="room-options">
            <div class="img-card" onclick="selectImg('room', '硬派水泥工業風', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E7%A1%AC%E6%B4%BE%E6%B0%B4%E6%B3%A5%E5%B7%A5%E6%A5%AD%E9%A2%A8.jpg"><p>硬派水泥工業風</p></div>
            <div class="img-card" onclick="selectImg('room', '溫潤木質北歐風', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E6%BA%AB%E6%BD%A4%E6%9C%A8%E8%B3%AA%E5%8C%97%E6%AD%90%E9%A2%A8.jpg"><p>溫潤木質北歐風</p></div>
            <div class="img-card" onclick="selectImg('room', '純粹極簡風', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E7%B4%94%E7%B2%B9%E6%A5%B5%E7%B0%A1%E9%A2%A8.jpg"><p>純粹極簡風</p></div>
            <div class="img-card" onclick="selectImg('room', '植栽綠意風', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E6%A4%8D%E6%A0%BD%E7%B6%A0%E6%84%8F%E9%A2%A8.jpg"><p>植栽綠意風</p></div>
            <div class="img-card" onclick="selectImg('room', '華麗古典風', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E8%8F%AF%E9%BA%97%E5%8F%A4%E5%85%B8%E9%A2%A8.jpg"><p>華麗古典風</p></div>
        </div>
        <input type="hidden" id="Q7_val">
    </div>

    <div class="question-group">
        <label>13. 如果要把你們的故事做成雜誌封面，您選擇哪種排版？</label>
        <div class="image-options" id="mag-options">
            <div class="img-card" onclick="selectImg('mag', '時尚留白', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E6%99%82%E5%B0%9A%E7%95%99%E7%99%BD%E9%9B%9C%E8%AA%8C.jpg"><p>時尚留白</p></div>
            <div class="img-card" onclick="selectImg('mag', '大膽色塊', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E5%A4%A7%E8%86%BD%E8%89%B2%E5%A1%8A%E9%A2%A8%E6%A0%BC%E9%9B%9C%E8%AA%8C.jpg"><p>大膽色塊</p></div>
            <div class="img-card" onclick="selectImg('mag', '人文藝術', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E4%BA%BA%E6%96%87%E8%97%9D%E8%A1%93%E9%A2%A8%E6%A0%BC%E9%9B%9C%E8%AA%8C.jpg"><p>人文藝術</p></div>
            <div class="img-card" onclick="selectImg('mag', '經典排版', this)"><img src="https://raw.githubusercontent.com/brendon-create/duet-openscad/main/images/%E7%B6%93%E5%85%B8%E6%8E%92%E7%89%88%E9%A2%A8%E6%A0%BC%E9%9B%9C%E8%AA%8C.jpg"><p>經典排版</p></div>
        </div>
        <input type="hidden" id="Q8_val">
    </div>

    <div class="question-group" style="background: rgba(212, 175, 55, 0.05); padding: 30px; border-radius: 15px; border: 1px dashed var(--gold);">
        <label style="text-align: center;">14. 選擇字體</label>
        <div class="font-selection-wrapper">
            <div class="font-selection-item">
                <label id="btn_label_L1" style="font-size: 18px;">字母 ？ 字體</label>
                <div id="font1_display" class="font-trigger" onclick="openFontSelector(1)">點擊挑選</div>
            </div>
            <div class="font-selection-item">
                <label id="btn_label_L2" style="font-size: 18px;">字母 ？ 字體</label>
                <div id="font2_display" class="font-trigger" onclick="openFontSelector(2)">點擊挑選</div>
            </div>
        </div>
    </div>

    <div class="question-group">
        <label id="label_Q15">15. 字母 ？ 選擇 ？ 字體的原因？</label>
        <textarea id="font1_r" rows="2"></textarea>
    </div>

    <div class="question-group">
        <label id="label_Q16">16. 字母 ？ 選擇 ？ 字體的原因？</label>
        <textarea id="font2_r" rows="2"></textarea>
    </div>

    <button id="submitBtn" class="submit-btn" onclick="submitForm()">確認提交回覆</button>
</div>

<div id="font-selector-modal"><div class="modal-body"><h2 id="modal-title" style="color:var(--gold); padding:20px;">挑選字體</h2><div class="font-grid" id="font-list-container"></div><button onclick="closeFontSelector()" style="width:100%; padding:15px; background:#444; color:#fff; border:none; cursor:pointer;">關閉視窗</button></div></div>

<script>
    const allFonts = ["Abel", "Abril Fatface", "Advent Pro", "Alegreya", "Alex Brush", "Alfa Slab One", "Alice", "Allura", "Amatic SC", "Amiri", "Anton", "Arapey", "Archivo", "Armata", "Artifika", "Arvo", "Audiowide", "Average", "Baloo 2", "Bangers", "Bebas Neue", "Belgrano", "Bentham", "Bitter", "Bree Serif", "Bubblegum Sans", "Bungee", "Cabin", "Cantata One", "Caudex", "Caveat", "Chivo", "Cinzel", "Comfortaa", "Commissioner", "Cookie", "Copse", "Cormorant Garamond", "Courier Prime", "Coustard", "Creepster", "Cutive Mono", "DM Serif Text", "Dancing Script", "Dosis", "EB Garamond", "Eczar", "Encode Sans", "Fauna One", "Fira Code", "Fira Sans", "Fjalla One", "Fugaz One", "Gelasio", "Gloria Hallelujah", "Great Vibes", "Handlee", "Hind", "Holtwood One SC", "Inconsolata", "Indie Flower", "Jost", "Kalam", "Kanit", "Karla", "Lexend", "Lobster", "Merriweather", "Neuton", "Nunito", "Old Standard TT", "Orbitron", "Oswald", "Outfit", "Pacifico", "Passion One", "Pathway Gothic One", "Patrick Hand", "Paytone One", "Playfair Display", "Poppins", "Prata", "Quicksand", "Righteous", "Rubik", "Russo One", "Sacramento", "Secular One", "Shadows Into Light", "Share Tech Mono", "Shrikhand", "Sniglet", "Space Grotesk", "Space Mono", "Spectral", "Tangerine", "Titan One", "Varela Round", "Vollkorn", "Zilla Slab"];

    const scriptURL = "https://script.google.com/macros/s/AKfycbwqPAlaIjQR3G4xn6ZMe4gx_DAyJeMVBrQIZzpoUQYwtAy7oQhlrt_ZVCkoShExXV6K7w/exec";
    let activeSlot = 1;

    function updateDynamicLabels() {
        const l1 = document.getElementById('L1').value || "？";
        const l2 = document.getElementById('L2').value || "？";
        const f1 = document.getElementById('font1_display').textContent === "點擊挑選" ? "？" : document.getElementById('font1_display').textContent;
        const f2 = document.getElementById('font2_display').textContent === "點擊挑選" ? "？" : document.getElementById('font2_display').textContent;

        document.getElementById('label_Q2').textContent = `2. 「${l1}」對您的意義是什麼？`;
        document.getElementById('label_Q3').textContent = `3. 「${l2}」對您的意義是什麼？`;
        document.getElementById('btn_label_L1').textContent = `字母 ${l1} 字體`;
        document.getElementById('btn_label_L2').textContent = `字母 ${l2} 字體`;
        document.getElementById('label_Q15').textContent = `15. 字母 ${l1} 選擇 ${f1} 字體的原因？`;
        document.getElementById('label_Q16').textContent = `16. 字母 ${l2} 選擇 ${f2} 字體的原因？`;
    }

    function openFontSelector(slot) {
        activeSlot = slot;
        const targetChar = (slot === 1) ? (document.getElementById('L1').value || "A") : (document.getElementById('L2').value || "B");
        const container = document.getElementById('font-list-container');
        container.innerHTML = '';
        allFonts.forEach(font => {
            const card = document.createElement('div');
            card.className = 'font-card';
            card.style.fontFamily = `'${font}', sans-serif`;
            card.innerHTML = `<div class="preview-char">${targetChar}</div><div>${font}</div>`;
            
            const link = document.createElement('link');
            link.href = `https://fonts.googleapis.com/css2?family=${font.replace(/ /g, '+')}&display=swap`;
            link.rel = 'stylesheet';
            document.head.appendChild(link);

            card.onclick = () => {
                const displayDiv = document.getElementById(`font${activeSlot}_display`);
                displayDiv.textContent = font;
                displayDiv.style.fontFamily = `'${font}', sans-serif`;
                updateDynamicLabels();
                closeFontSelector();
            };
            container.appendChild(card);
        });
        document.getElementById('font-selector-modal').style.display = 'block';
    }

    function closeFontSelector() { document.getElementById('font-selector-modal').style.display = 'none'; }
    
    function selectImg(type, val, el) {
        document.querySelectorAll(`#${type}-options .img-card`).forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        document.getElementById(`Q${type==='room'?7:8}_val`).value = val;
    }

    function submitForm() {
        const btn = document.getElementById('submitBtn');
        const name = document.getElementById('name').value;
        if(!name) { alert("請填寫您的姓名"); return; }
        
        btn.disabled = true; btn.textContent = "發送中...";
        const data = {
            name: name,
            email: document.getElementById('email').value,
            L1: document.getElementById('L1').value,
            L2: document.getElementById('L2').value,
            Q1_reason: document.getElementById('Q1_reason').value,
            Q1_2_reason: document.getElementById('Q1_2_reason').value,
            Q2: document.getElementById('Q2').value,
            Q2_5: document.getElementById('Q2_5').value,
            Q3: document.getElementById('Q3').value,
            Q3_5: document.getElementById('Q3_5').value,
            Q4: document.getElementById('Q4').value,
            Q5: document.getElementById('Q5').value,
            Q5_5: document.getElementById('Q5_5').value,
            Q6: document.getElementById('Q6').value,
            Q7: document.getElementById('Q7_val').value,
            Q8: document.getElementById('Q8_val').value,
            font1: document.getElementById('font1_display').textContent,
            font2: document.getElementById('font2_display').textContent,
            font1_r: document.getElementById('font1_r').value,
            font2_r: document.getElementById('font2_r').value
        };
        fetch(scriptURL + "?" + new URLSearchParams(data).toString(), { method: 'POST' })
            .then(() => { alert("提交成功！謝謝你為DUET注入靈魂～"); btn.textContent = "已完成"; })
            .catch(() => { alert("提交失敗。"); btn.disabled = false; btn.textContent = "確認提交回覆"; });
    }
    updateDynamicLabels();
</script>
</body>
</html>